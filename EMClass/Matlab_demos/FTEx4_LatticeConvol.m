% FTEx4.m%% demonstrate the FT of a lattice and convolution with an object.% Hit space to show the final answer.  Upper row of figure is real-space;% lower row is Fourier space.  You can change n1 to change the lattice% spacing.disp('FTEx4: convolution of lattice with an object');figure(2);set(gcf,'menubar','none');set(gcf,'toolbar','none');set(gcf,'color',[0.3 0.3 0.3]);n=150;% n1 is the lattice spacing% 30 is undersampled, 50 or 75 are well sampled.n1=30; % ..........nr=2;nr=2;nc=3;  % number of rows, columns in figure.sm=double(imread('smiley.tiff'));sm=(255-sm')/255;sz=size(sm);ns=min(sz);  % smallest dimension of object% Create a latticerl=zeros(n,n);rl(1:n1:n,1:n1:n)=1;figure(2); clf;set(gcf,'color',[0.3 0.3 0.3]);SetComplex;subplot(nr,nc,1);imacs(fftshift(rl));axis off% FT of latticefl=fft2(rl);subplot(nr,nc,4);imacs(fftshift(real(fl)));title('Fourier sampling function');axis offdrawnow;% objectrm=zeros(n,n);ctr=n/2+1;rm(ctr-ns/2:ctr+ns/2-1,ctr-ns/2:ctr+ns/2-1)=sm(1:ns,ns:-1:1);rm=rm-mean(mean(rm));% rm=GaussFilt2(rm,0.2);subplot(nr,nc,2);imacs(rm);axis off% FT of objectfm=fft2(fftshift(rm));subplot(nr,nc,5);imacx(fftshift(fm),0.5);title('FT of Smiley');axis offdrawnow;% object in latticeflm=fl.*fm;subplot(nr,nc,6);imacx(fftshift(flm),0.5);title('Sampled FT');axis offpauserlm=ifft2(flm);subplot(nr,nc,3);imacs(fftshift(real(rlm)));axis off% rlf=gaussfilt2(rl,.05);% imacs(rlf);