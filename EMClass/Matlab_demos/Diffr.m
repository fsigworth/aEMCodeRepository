% Diffraction structure demonstration load pennyfigure(1);clf;subplot(2,3,1);setgrayscale;imagesc(P);title('object');P=P-mean(mean(P));fp=fft2(P);fps=fftshift(fp); fps(65,65)=0;subplot(2,3,2);imagesc(sqrt(abs(fps)));title('abs(FT)');subplot(2,3,3);spect=abs(fp);imagesc(sqrt(fftshift(abs(ifft2(spect)))));title('autocorrelation');pause;subplot(2,3,4);imagesc(real(ifft2(real(fp))));title('F^{-1}[Re(f)]');subplot(2,3,5);imagesc(imag(ifft2(imag(fp))));title('F^{-1}[Im(f)]');subplot(2,3,6);imagesc(real(ifft2(fp)));title('reconstruction');